# 機能要件定義書

## 文書情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | Multi-Mode Calculator |
| 文書バージョン | 1.0 |
| 作成日 | 2025-12-11 |
| 最終更新日 | 2025-12-11 |

---

## 1. 標準電卓モード

### FR-STD-001: 数値入力

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-001 |
| 要件名 | 数値入力 |
| 優先度 | 必須 |

**説明：**
システムは、ユーザーが0〜9の数字ボタンまたはキーボードの数字キーを押下したとき、ディスプレイに該当する数字を追加表示する。

**入力：**
- ボタン押下：0, 1, 2, 3, 4, 5, 6, 7, 8, 9
- キーボード：0-9キー、テンキー0-9

**処理：**
1. 現在のディスプレイ値が「0」の場合、入力数字で置換する
2. 現在のディスプレイ値が「0」以外の場合、末尾に入力数字を追加する
3. 桁数が15桁を超える場合、入力を無視する

**出力：**
- ディスプレイに数値を表示

---

### FR-STD-002: 小数点入力

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-002 |
| 要件名 | 小数点入力 |
| 優先度 | 必須 |

**説明：**
システムは、ユーザーが小数点ボタンまたはキーボードのピリオドキーを押下したとき、ディスプレイに小数点を追加する。

**処理：**
1. 現在の入力値に小数点が含まれていない場合のみ、小数点を追加する
2. 既に小数点が含まれている場合、入力を無視する

---

### FR-STD-003: 四則演算

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-003 |
| 要件名 | 四則演算 |
| 優先度 | 必須 |

**説明：**
システムは、以下の四則演算をサポートする。

| 演算子 | ボタン表示 | キーボード | 処理 |
|--------|-----------|------------|------|
| 加算 | + | + | 左辺 + 右辺 |
| 減算 | − | - | 左辺 − 右辺 |
| 乗算 | × | * | 左辺 × 右辺 |
| 除算 | ÷ | / | 左辺 ÷ 右辺 |

**処理：**
1. ユーザーが演算子を押下したとき、現在の入力値を左辺として保持する
2. 次の数値入力を右辺として受け付ける
3. 「=」またはEnterキー押下時に計算を実行する
4. 連続して演算子を押下した場合、直前の演算子を新しい演算子で置換する

---

### FR-STD-004: イコール（計算実行）

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-004 |
| 要件名 | イコール（計算実行） |
| 優先度 | 必須 |

**説明：**
システムは、「=」ボタンまたはEnterキー押下時に計算を実行し、結果を表示する。

**処理：**
1. 保持している左辺、演算子、右辺を使用して計算を実行する
2. 計算結果をディスプレイに表示する
3. 計算式と結果を履歴に追加する
4. 結果を次の計算の左辺として保持する

---

### FR-STD-005: パーセント計算

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-005 |
| 要件名 | パーセント計算 |
| 優先度 | 必須 |

**説明：**
システムは、パーセントボタン押下時に現在の値を100で除算した値を表示する。

**例：**
- 入力「50」→ %押下 → 表示「0.5」
- 「100 + 20%」 → 結果「120」（100の20%である20を加算）

---

### FR-STD-006: 符号反転

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-006 |
| 要件名 | 符号反転 |
| 優先度 | 必須 |

**説明：**
システムは、「±」ボタン押下時に現在の値の符号を反転する。

**処理：**
- 正の数 → 負の数
- 負の数 → 正の数
- 0 → 0（変化なし）

---

### FR-STD-007: クリア（C）

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-007 |
| 要件名 | クリア（C） |
| 優先度 | 必須 |

**説明：**
システムは、「C」ボタンまたはEscapeキー押下時に全ての入力と計算状態をクリアする。

**処理：**
1. ディスプレイを「0」にリセットする
2. 保持している左辺、演算子をクリアする
3. 計算式表示をクリアする

---

### FR-STD-008: クリアエントリー（CE）

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-008 |
| 要件名 | クリアエントリー（CE） |
| 優先度 | 必須 |

**説明：**
システムは、「CE」ボタン押下時に現在入力中の値のみをクリアする。

**処理：**
1. ディスプレイを「0」にリセットする
2. 保持している左辺、演算子は維持する

---

### FR-STD-009: バックスペース

| 項目 | 内容 |
|------|------|
| 要件ID | FR-STD-009 |
| 要件名 | バックスペース |
| 優先度 | 必須 |

**説明：**
システムは、バックスペースボタンまたはBackspaceキー押下時に最後の1文字を削除する。

**処理：**
1. 現在のディスプレイ値の最後の1文字を削除する
2. 全ての文字が削除された場合、「0」を表示する

---

## 2. 関数電卓モード

### FR-SCI-001: 三角関数

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-001 |
| 要件名 | 三角関数 |
| 優先度 | 必須 |

**説明：**
システムは、以下の三角関数をサポートする。

| 関数 | ボタン | 説明 | 入力単位 |
|------|--------|------|----------|
| サイン | sin | 正弦 | ラジアン |
| コサイン | cos | 余弦 | ラジアン |
| タンジェント | tan | 正接 | ラジアン |
| アークサイン | sin⁻¹ | 逆正弦 | - |
| アークコサイン | cos⁻¹ | 逆余弦 | - |
| アークタンジェント | tan⁻¹ | 逆正接 | - |

**処理：**
1. 角度モード（DEG/RAD）に応じて入力値を変換する
2. 該当する三角関数を適用する
3. 結果を表示する

---

### FR-SCI-002: 角度モード切り替え

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-002 |
| 要件名 | 角度モード切り替え |
| 優先度 | 必須 |

**説明：**
システムは、度数法（DEG）とラジアン法（RAD）を切り替える機能を提供する。

| モード | 説明 | 変換式 |
|--------|------|--------|
| DEG | 度数法 | rad = deg × (π / 180) |
| RAD | ラジアン法 | そのまま使用 |

---

### FR-SCI-003: 対数関数

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-003 |
| 要件名 | 対数関数 |
| 優先度 | 必須 |

**説明：**
システムは、以下の対数関数をサポートする。

| 関数 | ボタン | 説明 |
|------|--------|------|
| 常用対数 | log | log₁₀(x) |
| 自然対数 | ln | logₑ(x) |

**エラー処理：**
- 入力値が0以下の場合、「Error」を表示する

---

### FR-SCI-004: 指数・累乗

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-004 |
| 要件名 | 指数・累乗 |
| 優先度 | 必須 |

**説明：**
システムは、以下の指数・累乗計算をサポートする。

| 関数 | ボタン | 説明 |
|------|--------|------|
| 2乗 | x² | x × x |
| 3乗 | x³ | x × x × x |
| n乗 | xⁿ | x^n（底xを指数n乗） |
| 自然指数 | eˣ | e^x |
| 10のn乗 | 10ˣ | 10^x |

---

### FR-SCI-005: ルート・根

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-005 |
| 要件名 | ルート・根 |
| 優先度 | 必須 |

**説明：**
システムは、以下のルート計算をサポートする。

| 関数 | ボタン | 説明 |
|------|--------|------|
| 平方根 | √ | √x |
| 立方根 | ³√ | ³√x |
| n乗根 | ⁿ√ | ⁿ√x |

**エラー処理：**
- 負の数の偶数乗根の場合、「Error」を表示する

---

### FR-SCI-006: 階乗

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-006 |
| 要件名 | 階乗 |
| 優先度 | 必須 |

**説明：**
システムは、「n!」ボタン押下時に階乗を計算する。

**処理：**
- n! = n × (n-1) × (n-2) × ... × 2 × 1
- 0! = 1

**エラー処理：**
- 負の数または小数の場合、「Error」を表示する
- 結果がJavaScriptの数値範囲を超える場合、「Infinity」を表示する

---

### FR-SCI-007: 定数

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-007 |
| 要件名 | 定数 |
| 優先度 | 必須 |

**説明：**
システムは、以下の数学定数を提供する。

| 定数 | ボタン | 値 |
|------|--------|-----|
| 円周率 | π | 3.141592653589793 |
| ネイピア数 | e | 2.718281828459045 |

---

### FR-SCI-008: 逆数

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-008 |
| 要件名 | 逆数 |
| 優先度 | 必須 |

**説明：**
システムは、「1/x」ボタン押下時に逆数を計算する。

**エラー処理：**
- 入力値が0の場合、「Error」を表示する

---

### FR-SCI-009: 絶対値

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-009 |
| 要件名 | 絶対値 |
| 優先度 | 必須 |

**説明：**
システムは、「|x|」ボタン押下時に絶対値を返す。

---

### FR-SCI-010: 括弧

| 項目 | 内容 |
|------|------|
| 要件ID | FR-SCI-010 |
| 要件名 | 括弧 |
| 優先度 | 必須 |

**説明：**
システムは、括弧を使用した演算順序の制御をサポートする。

**処理：**
- 「(」で計算のネストを開始する
- 「)」でネストを終了し、括弧内を先に計算する
- 最大ネスト深度：10階層

---

## 3. プログラマ電卓モード

### FR-PRG-001: 進数入力モード

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-001 |
| 要件名 | 進数入力モード |
| 優先度 | 必須 |

**説明：**
システムは、以下の進数モードでの入力をサポートする。

| モード | 表示 | 使用可能文字 |
|--------|------|-------------|
| 2進数 | BIN | 0, 1 |
| 8進数 | OCT | 0-7 |
| 10進数 | DEC | 0-9 |
| 16進数 | HEX | 0-9, A-F |

**処理：**
1. 進数モードを選択する
2. 選択したモードで有効な文字のみ入力を受け付ける
3. 無効な文字の入力は無視する

---

### FR-PRG-002: 進数同時表示

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-002 |
| 要件名 | 進数同時表示 |
| 優先度 | 必須 |

**説明：**
システムは、入力値を全ての進数で同時に表示する。

**表示例（入力：255 in DEC）：**
```
HEX: FF
DEC: 255
OCT: 377
BIN: 11111111
```

---

### FR-PRG-003: ビット演算

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-003 |
| 要件名 | ビット演算 |
| 優先度 | 必須 |

**説明：**
システムは、以下のビット演算をサポートする。

| 演算 | ボタン | 説明 | 例 |
|------|--------|------|-----|
| AND | AND | 論理積 | 1010 AND 1100 = 1000 |
| OR | OR | 論理和 | 1010 OR 1100 = 1110 |
| XOR | XOR | 排他的論理和 | 1010 XOR 1100 = 0110 |
| NOT | NOT | 否定（ビット反転） | NOT 1010 = 0101 |
| 左シフト | << | 左にnビットシフト | 0001 << 2 = 0100 |
| 右シフト | >> | 右にnビットシフト | 1000 >> 2 = 0010 |

---

### FR-PRG-004: ビット長設定

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-004 |
| 要件名 | ビット長設定 |
| 優先度 | 必須 |

**説明：**
システムは、演算対象のビット長を設定できる。

| 設定 | ビット数 | 最大値（符号なし） |
|------|----------|-------------------|
| BYTE | 8 | 255 |
| WORD | 16 | 65,535 |
| DWORD | 32 | 4,294,967,295 |
| QWORD | 64 | 18,446,744,073,709,551,615 |

---

### FR-PRG-005: ASCII変換

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-005 |
| 要件名 | ASCII変換 |
| 優先度 | 必須 |

**説明：**
システムは、16進数とASCII文字の相互変換機能を提供する。

#### 5.1 HEX → ASCII変換

**入力形式：**
- スペース区切りの16進数値（例：48 65 6C 6C 6F）
- 連続した16進数値（例：48656C6C6F）

**出力：**
- 対応するASCII文字列（例：Hello）

**処理：**
1. 入力された16進数を2文字ずつ解析する
2. 各2文字を1バイトとして解釈する
3. ASCIIコード表に基づいて文字に変換する
4. 印字不可能文字（0x00-0x1F, 0x7F）は「.」で表示する

#### 5.2 ASCII → HEX変換

**入力：**
- 任意のASCII文字列

**出力：**
- 各文字に対応する16進数値（スペース区切り）

**例：**
- 入力「Hello」→ 出力「48 65 6C 6C 6F」

---

### FR-PRG-006: 2の補数表示

| 項目 | 内容 |
|------|------|
| 要件ID | FR-PRG-006 |
| 要件名 | 2の補数表示 |
| 優先度 | 任意 |

**説明：**
システムは、負の数を2の補数形式で表示するオプションを提供する。

---

## 4. 共通機能

### FR-CMN-001: モード切り替え

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-001 |
| 要件名 | モード切り替え |
| 優先度 | 必須 |

**説明：**
システムは、3つの電卓モード（標準、関数、プログラマ）を切り替えるタブまたはボタンを提供する。

**処理：**
1. モード切り替えボタンを押下する
2. 対応するモードのUIに切り替える
3. 現在の入力値は維持する（可能な範囲で）
4. 計算状態（左辺、演算子）はクリアする

---

### FR-CMN-002: 計算履歴表示

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-002 |
| 要件名 | 計算履歴表示 |
| 優先度 | 必須 |

**説明：**
システムは、過去の計算履歴を一覧表示する機能を提供する。

**表示形式：**
```
2 + 3 = 5
10 × 5 = 50
sin(90°) = 1
FF (HEX) = 255 (DEC)
```

**処理：**
1. 履歴パネルを開く
2. 過去の計算を新しい順に表示する
3. 各履歴項目をクリックで結果値を入力欄に反映する

---

### FR-CMN-003: 履歴クリア

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-003 |
| 要件名 | 履歴クリア |
| 優先度 | 必須 |

**説明：**
システムは、計算履歴を全て削除する機能を提供する。

---

### FR-CMN-004: テーマ選択

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-004 |
| 要件名 | テーマ選択 |
| 優先度 | 必須 |

**説明：**
システムは、10種類のデザインテーマを提供し、ユーザーが選択できる。

**テーマ一覧：**

| No | テーマ名 | 特徴 |
|----|----------|------|
| 1 | Default | シンプルなグレー基調 |
| 2 | Ocean | 青・水色のグラデーション |
| 3 | Forest | 緑・自然をイメージ |
| 4 | Sunset | オレンジ・赤のグラデーション |
| 5 | Midnight | 深い紺・紫 |
| 6 | Cherry | ピンク・桜色 |
| 7 | Monochrome | 白黒のシンプルデザイン |
| 8 | Neon | 蛍光色・サイバーパンク風 |
| 9 | Wooden | 木目調・ナチュラル |
| 10 | Glass | 透明感・ガラス風 |

---

### FR-CMN-005: ライト/ダークモード

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-005 |
| 要件名 | ライト/ダークモード |
| 優先度 | 必須 |

**説明：**
システムは、ライトモードとダークモードを切り替える機能を提供する。

**処理：**
1. 切り替えボタンを押下する
2. 現在のテーマに対してライト/ダークの配色を適用する
3. 設定をローカルストレージに保存する

---

### FR-CMN-006: キーボードショートカット

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-006 |
| 要件名 | キーボードショートカット |
| 優先度 | 必須 |

**説明：**
システムは、以下のキーボードショートカットをサポートする。

**共通：**

| キー | 機能 |
|------|------|
| 0-9 | 数字入力 |
| . | 小数点 |
| + | 加算 |
| - | 減算 |
| * | 乗算 |
| / | 除算 |
| Enter | 計算実行 |
| Backspace | 1文字削除 |
| Escape | クリア（C） |
| Delete | クリアエントリー（CE） |

**プログラマモード追加：**

| キー | 機能 |
|------|------|
| A-F | 16進数入力（HEXモード時） |

---

### FR-CMN-007: 設定永続化

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-007 |
| 要件名 | 設定永続化 |
| 優先度 | 必須 |

**説明：**
システムは、以下の設定をローカルストレージに保存し、次回アクセス時に復元する。

**保存項目：**
- 選択中のテーマ
- ライト/ダークモード設定
- 最後に使用した電卓モード
- 角度モード（DEG/RAD）
- ビット長設定
- 計算履歴

---

### FR-CMN-008: レスポンシブ対応

| 項目 | 内容 |
|------|------|
| 要件ID | FR-CMN-008 |
| 要件名 | レスポンシブ対応 |
| 優先度 | 必須 |

**説明：**
システムは、以下の画面サイズに対応したレイアウトを提供する。

| デバイス | 画面幅 | レイアウト |
|----------|--------|-----------|
| デスクトップ | 1024px以上 | フル表示 |
| タブレット | 768px〜1023px | 中間レイアウト |
| スマートフォン | 767px以下 | コンパクトレイアウト |

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 変更者 |
|------|------------|----------|--------|
| 2025-12-11 | 1.0 | 初版作成 | Claude Code |
