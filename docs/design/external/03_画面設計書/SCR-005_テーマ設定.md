# 画面設計書: SCR-005 テーマ設定モーダル

## 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | SCR-005 |
| 画面名 | テーマ設定モーダル |
| 対応機能要件 | FR-CMN-004, FR-CMN-007 |
| 作成日 | 2025-12-11 |
| 更新日 | 2025-12-13 |
| 作成者 | Claude Code |

---

## 設計変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2025-12-13 | UI改善: ダイアログ→モーダル形式に変更、ライト/ダークモード切替をヘッダーに移動 |

---

## 画面レイアウト

```
【モーダルオーバーレイ】
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                   （半透明背景）                             │
│                                                             │
│    ┌───────────────────────────────────────────────┐       │
│    │  テーマ設定                              [×]   │       │
│    ├───────────────────────────────────────────────┤       │
│    │                                               │       │
│    │  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐│       │
│    │  │      │ │      │ │      │ │      │ │      ││       │
│    │  │Deflt │ │Ocean │ │Forest│ │Sunset│ │Mid-  ││       │
│    │  │  ✓   │ │      │ │      │ │      │ │night ││       │
│    │  └──────┘ └──────┘ └──────┘ └──────┘ └──────┘│       │
│    │                                               │       │
│    │  ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐ ┌──────┐│       │
│    │  │      │ │      │ │      │ │      │ │      ││       │
│    │  │Cherry│ │ Mono │ │ Neon │ │Wooden│ │Glass ││       │
│    │  │      │ │      │ │      │ │      │ │      ││       │
│    │  └──────┘ └──────┘ └──────┘ └──────┘ └──────┘│       │
│    │                                               │       │
│    └───────────────────────────────────────────────┘       │
│                                                             │
│                   （半透明背景）                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘

※ ダークモード切替は⚙️ではなく☀️/🌙ボタン（ヘッダー）で行う
※ テーマ選択は即時適用（保存/キャンセルボタン不要）
```

---

## 画面項目一覧

### モーダルヘッダー

| No | 項目ID | 項目名 | 種別 | 説明 |
|----|--------|--------|------|------|
| 1 | SCR005_lbl_title | タイトル | ラベル | 「テーマ設定」を表示 |
| 2 | SCR005_btn_close | 閉じるボタン | アイコンボタン | [×] モーダルを閉じる |

### テーマ選択グリッド（5列×2行）

| No | 項目ID | 項目名 | 種別 | 初期値 |
|----|--------|--------|------|--------|
| 3 | SCR005_theme_default | Default | テーマカード | 選択 |
| 4 | SCR005_theme_ocean | Ocean | テーマカード | 非選択 |
| 5 | SCR005_theme_forest | Forest | テーマカード | 非選択 |
| 6 | SCR005_theme_sunset | Sunset | テーマカード | 非選択 |
| 7 | SCR005_theme_midnight | Midnight | テーマカード | 非選択 |
| 8 | SCR005_theme_cherry | Cherry | テーマカード | 非選択 |
| 9 | SCR005_theme_mono | Monochrome | テーマカード | 非選択 |
| 10 | SCR005_theme_neon | Neon | テーマカード | 非選択 |
| 11 | SCR005_theme_wooden | Wooden | テーマカード | 非選択 |
| 12 | SCR005_theme_glass | Glass | テーマカード | 非選択 |

### オーバーレイ

| No | 項目ID | 項目名 | 種別 | 説明 |
|----|--------|--------|------|------|
| 13 | SCR005_overlay | 背景オーバーレイ | div | クリックでモーダルを閉じる |

---

## テーマ詳細

### テーマカラー定義

| テーマ名 | 主要色（ライト） | 主要色（ダーク） | 特徴 |
|----------|----------------|----------------|------|
| Default | #f0f0f0 / #333 | #2d2d2d / #fff | シンプルなグレー基調 |
| Ocean | #e3f2fd / #1565c0 | #0d47a1 / #90caf9 | 青・水色のグラデーション |
| Forest | #e8f5e9 / #2e7d32 | #1b5e20 / #a5d6a7 | 緑・自然をイメージ |
| Sunset | #fff3e0 / #e65100 | #bf360c / #ffcc80 | オレンジ・赤のグラデーション |
| Midnight | #e8eaf6 / #283593 | #1a237e / #9fa8da | 深い紺・紫 |
| Cherry | #fce4ec / #c2185b | #880e4f / #f48fb1 | ピンク・桜色 |
| Monochrome | #ffffff / #000000 | #121212 / #ffffff | 白黒のシンプルデザイン |
| Neon | #f3e5f5 / #7b1fa2 | #12005e / #ea80fc | 蛍光色・サイバーパンク風 |
| Wooden | #efebe9 / #5d4037 | #3e2723 / #d7ccc8 | 木目調・ナチュラル |
| Glass | #eceff1 / #455a64 | #263238 / #b0bec5 | 透明感・ガラス風 |

### テーマカードのレイアウト

```
┌──────────────────────────┐
│  ┌────────────────────┐ │
│  │                    │ │  ← プレビューエリア
│  │   [プレビュー]     │ │    （電卓ミニチュア）
│  │                    │ │
│  └────────────────────┘ │
│                          │
│      テーマ名            │
│                          │
│        [✓]              │  ← 選択中表示
└──────────────────────────┘
```

---

## アクション定義

### テーマ選択

| No | トリガー | アクション | 結果 |
|----|---------|-----------|------|
| 1 | テーマカードクリック | テーマを即座に適用 | 電卓の配色変更 |
| 2 | テーマ選択 | 選択中マーク(✓)を更新 | UIフィードバック |
| 3 | テーマ変更 | LocalStorageに保存 | 設定永続化 |
| 4 | テーマカードホバー | ホバー状態を表示 | 視覚的フィードバック |

### モーダル操作

| No | トリガー | アクション | 結果 |
|----|---------|-----------|------|
| 5 | 閉じるボタン[×]押下 | モーダルを閉じる | モーダル非表示 |
| 6 | オーバーレイ（背景）クリック | モーダルを閉じる | モーダル非表示 |
| 7 | Escapeキー押下 | モーダルを閉じる | モーダル非表示 |

### ダークモード切替（ヘッダーから操作）

| No | トリガー | アクション | 結果 |
|----|---------|-----------|------|
| 8 | ☀️/🌙アイコンクリック（ヘッダー） | ライト⇔ダークモード切替 | 即座に配色変更、アイコン更新 |
| 9 | モード変更 | LocalStorageに保存 | 設定永続化 |

※ ダークモード切替はテーマ設定モーダルではなく、ヘッダーの☀️/🌙アイコンで行う

---

## CSS変数構造

### テーマ適用の仕組み

```css
/* テーマ変数の例（Default - Light） */
:root[data-theme="default"][data-mode="light"] {
  --color-bg-primary: #f0f0f0;
  --color-bg-secondary: #e0e0e0;
  --color-text-primary: #333333;
  --color-text-secondary: #666666;
  --color-accent: #2196f3;
  --color-button-num: #ffffff;
  --color-button-op: #ff9800;
  --color-button-func: #e0e0e0;
  --color-display-bg: #ffffff;
  --color-display-text: #333333;
  --shadow-button: 0 2px 4px rgba(0,0,0,0.1);
  --border-radius: 8px;
}

/* テーマ変数の例（Default - Dark） */
:root[data-theme="default"][data-mode="dark"] {
  --color-bg-primary: #2d2d2d;
  --color-bg-secondary: #3d3d3d;
  --color-text-primary: #ffffff;
  --color-text-secondary: #b0b0b0;
  /* ... */
}
```

---

## LocalStorage保存形式

```json
{
  "calc_theme": "default",
  "calc_darkMode": false
}
```

| キー | 型 | 説明 | 有効値 |
|------|-----|------|--------|
| calc_theme | string | 選択中のテーマ名 | default, ocean, forest, sunset, midnight, cherry, mono, neon, wooden, glass |
| calc_darkMode | boolean | ダークモード有効フラグ | true, false |

---

## 初期表示時の動作

| No | 処理 | 説明 |
|----|------|------|
| 1 | LocalStorage読み込み | 保存済みの設定を取得 |
| 2 | テーマ適用 | 保存されたテーマを適用 |
| 3 | モード適用 | 保存されたライト/ダークモードを適用 |
| 4 | 選択状態反映 | ダイアログ表示時に現在の選択を表示 |

---

## 補足事項

1. **即時反映**: テーマ選択は即座に電卓UIに反映（保存ボタン不要）
2. **プレビュー**: テーマカードには電卓のミニチュアプレビューを表示
3. **アクセシビリティ**: 全テーマでコントラスト比4.5:1以上を確保
4. **アニメーション**: テーマ切り替え時にスムーズなトランジション（0.3秒）
5. **モーダル表示**: 中央配置、背景オーバーレイはrgba(0,0,0,0.5)
6. **ダークモード**: ヘッダーの☀️/🌙アイコンでワンクリック切替（モーダル外）

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 変更者 |
|------|------------|----------|--------|
| 2025-12-11 | 1.0 | 初版作成 | Claude Code |
| 2025-12-13 | 2.0 | UI改善: モーダル形式に変更、ダークモード切替をヘッダーに移動 | Claude Code |
