# 画面設計書: SCR-002 関数電卓

## 基本情報

| 項目 | 内容 |
|------|------|
| 画面ID | SCR-002 |
| 画面名 | メイン画面（関数電卓） |
| 対応機能要件 | FR-SCI-001〜010, FR-CMN-001, 006, 007, 008 |
| 作成日 | 2025-12-11 |
| 更新日 | 2025-12-11 |
| 作成者 | Claude Code |

---

## 画面レイアウト

```
┌─────────────────────────────────────────────────────────────────────┐
│                     コンパクトヘッダーエリア                          │
│  ┌────────────────────────────────┐       ┌────┐┌────┐┌────┐      │
│  │ [標準] [関数▼] [プログラマ]     │       │ ☀️ ││ 📜 ││ ⚙️ │      │
│  │         ↑アクティブ            │       └────┘└────┘└────┘      │
│  └────────────────────────────────┘        ↑     ↑     ↑          │
│                                          ダーク 履歴  設定         │
├─────────────────────────────────────────────────────────────────────┤
│  角度モード: [ DEG ● ] [ RAD ○ ]                                    │
├─────────────────────────────────────────────────────────────────────┤
│                        ディスプレイエリア                            │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                                          sin(90) =          │   │
│  │                                                    1        │   │
│  └─────────────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────────────┤
│                         ボタンエリア                                 │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  [sin]  [cos]  [tan]   [π]   [e]   [CE]  [C]   [⌫]         │   │
│  │  [sin⁻¹][cos⁻¹][tan⁻¹] [x²]  [x³]  [xⁿ]  [÷]              │   │
│  │  [log]  [ln]   [eˣ]    [10ˣ] [√]   [³√]  [×]              │   │
│  │  [n!]   [1/x]  [|x|]   [(]   [)]   [%]   [−]              │   │
│  │  [7]    [8]    [9]                        [+]              │   │
│  │  [4]    [5]    [6]                                         │   │
│  │  [1]    [2]    [3]                        [=]              │   │
│  │  [±]    [0]    [.]                                         │   │
│  └─────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 画面項目一覧

### 角度モード選択

| No | 項目ID | 項目名 | 種別 | 初期値 | 備考 |
|----|--------|--------|------|--------|------|
| 1 | SCR002_rb_deg | DEGモード | ラジオ | 選択 | 度数法 |
| 2 | SCR002_rb_rad | RADモード | ラジオ | 非選択 | ラジアン法 |

### 関数ボタン（三角関数）

| No | 項目ID | 項目名 | 表示 | 機能 |
|----|--------|--------|------|------|
| 3 | SCR002_btn_sin | サイン | sin | sin(x) |
| 4 | SCR002_btn_cos | コサイン | cos | cos(x) |
| 5 | SCR002_btn_tan | タンジェント | tan | tan(x) |
| 6 | SCR002_btn_asin | アークサイン | sin⁻¹ | arcsin(x) |
| 7 | SCR002_btn_acos | アークコサイン | cos⁻¹ | arccos(x) |
| 8 | SCR002_btn_atan | アークタンジェント | tan⁻¹ | arctan(x) |

### 関数ボタン（対数・指数）

| No | 項目ID | 項目名 | 表示 | 機能 |
|----|--------|--------|------|------|
| 9 | SCR002_btn_log | 常用対数 | log | log₁₀(x) |
| 10 | SCR002_btn_ln | 自然対数 | ln | logₑ(x) |
| 11 | SCR002_btn_exp | 自然指数 | eˣ | e^x |
| 12 | SCR002_btn_pow10 | 10の累乗 | 10ˣ | 10^x |

### 関数ボタン（累乗・ルート）

| No | 項目ID | 項目名 | 表示 | 機能 |
|----|--------|--------|------|------|
| 13 | SCR002_btn_square | 2乗 | x² | x² |
| 14 | SCR002_btn_cube | 3乗 | x³ | x³ |
| 15 | SCR002_btn_power | n乗 | xⁿ | x^n |
| 16 | SCR002_btn_sqrt | 平方根 | √ | √x |
| 17 | SCR002_btn_cbrt | 立方根 | ³√ | ³√x |

### 関数ボタン（その他）

| No | 項目ID | 項目名 | 表示 | 機能 |
|----|--------|--------|------|------|
| 18 | SCR002_btn_factorial | 階乗 | n! | n! |
| 19 | SCR002_btn_reciprocal | 逆数 | 1/x | 1/x |
| 20 | SCR002_btn_abs | 絶対値 | \|x\| | \|x\| |
| 21 | SCR002_btn_pi | 円周率 | π | 3.141592653589793 |
| 22 | SCR002_btn_e | ネイピア数 | e | 2.718281828459045 |

### 括弧ボタン

| No | 項目ID | 項目名 | 表示 | 機能 |
|----|--------|--------|------|------|
| 23 | SCR002_btn_lparen | 左括弧 | ( | 括弧開始 |
| 24 | SCR002_btn_rparen | 右括弧 | ) | 括弧終了 |

---

## アクション定義

### 三角関数

| No | トリガー | アクション | 条件 |
|----|---------|-----------|------|
| 1 | sin押下 | sin(現在値)を計算・表示 | DEGモード時は度→ラジアン変換後計算 |
| 2 | cos押下 | cos(現在値)を計算・表示 | DEGモード時は度→ラジアン変換後計算 |
| 3 | tan押下 | tan(現在値)を計算・表示 | DEGモード時は度→ラジアン変換後計算 |
| 4 | sin⁻¹押下 | arcsin(現在値)を計算・表示 | 入力値は-1〜1の範囲 |
| 5 | cos⁻¹押下 | arccos(現在値)を計算・表示 | 入力値は-1〜1の範囲 |
| 6 | tan⁻¹押下 | arctan(現在値)を計算・表示 | - |

### 対数関数

| No | トリガー | アクション | 条件 |
|----|---------|-----------|------|
| 7 | log押下 | log₁₀(現在値)を計算・表示 | 入力値 > 0 |
| 8 | ln押下 | logₑ(現在値)を計算・表示 | 入力値 > 0 |

### 指数・累乗

| No | トリガー | アクション | 条件 |
|----|---------|-----------|------|
| 9 | eˣ押下 | e^現在値を計算・表示 | - |
| 10 | 10ˣ押下 | 10^現在値を計算・表示 | - |
| 11 | xⁿ押下 | 次の入力を指数として待機 | - |

### 括弧演算

| No | トリガー | アクション | 条件 |
|----|---------|-----------|------|
| 12 | (押下 | 括弧のネストを開始 | ネスト深度10未満 |
| 13 | )押下 | 括弧内を計算、ネストを解除 | 開き括弧が存在 |

### 角度モード切り替え

| No | トリガー | アクション |
|----|---------|-----------|
| 14 | DEG選択 | 三角関数の入力を度数法として扱う |
| 15 | RAD選択 | 三角関数の入力をラジアンとして扱う |

---

## バリデーションルール

| 項目ID | ルール | エラー時の動作 |
|--------|--------|----------------|
| sin⁻¹, cos⁻¹ | 入力値: -1 ≤ x ≤ 1 | 「Error」表示 |
| log, ln | 入力値: x > 0 | 「Error」表示 |
| 階乗 | 入力値: 0以上の整数 | 「Error」表示 |
| 括弧 | 最大ネスト深度: 10 | 入力を無視 |
| √（偶数乗根） | 入力値 ≥ 0 | 「Error」表示 |

---

## エラーハンドリング

| エラーコード | 発生条件 | メッセージ |
|-------------|---------|-----------|
| ERR-SCI-001 | arcsin/arccosの範囲外 | Error |
| ERR-SCI-002 | 対数の定義域外（x≤0） | Error |
| ERR-SCI-003 | 負の数の階乗 | Error |
| ERR-SCI-004 | 小数の階乗 | Error |
| ERR-SCI-005 | 負の数の偶数乗根 | Error |
| ERR-SCI-006 | 結果がInfinity | Infinity |

---

## 角度変換ロジック

### DEG → RAD変換

```
radians = degrees × (π / 180)
```

### RAD → DEG変換（逆三角関数の結果）

```
degrees = radians × (180 / π)
```

---

## 補足事項

1. **関数の入力方式**: 関数ボタン押下後に即座に計算（後置記法）
2. **xⁿの入力方式**: 底を入力 → xⁿ押下 → 指数を入力 → =押下
3. **括弧の表示**: 開き括弧の数をディスプレイに表示
4. **定数入力**: π, e押下で即座に値を入力

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 変更者 |
|------|------------|----------|--------|
| 2025-12-11 | 1.0 | 初版作成 | Claude Code |
