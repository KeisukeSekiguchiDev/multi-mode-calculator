# 画面遷移図

## 文書情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | Multi-Mode Calculator |
| 文書バージョン | 1.0 |
| 作成日 | 2025-12-11 |
| 最終更新日 | 2025-12-11 |

---

## 1. 全体遷移図

```mermaid
graph TD
    subgraph メイン画面
        SCR001[SCR-001<br>標準電卓]
        SCR002[SCR-002<br>関数電卓]
        SCR003[SCR-003<br>プログラマ電卓]
    end

    subgraph パネル・ダイアログ
        SCR004[SCR-004<br>履歴パネル]
        SCR005[SCR-005<br>テーマ設定]
        SCR006[SCR-006<br>ASCII変換]
    end

    SCR001 <-->|タブ切替| SCR002
    SCR002 <-->|タブ切替| SCR003
    SCR001 <-->|タブ切替| SCR003

    SCR001 -->|履歴ボタン| SCR004
    SCR002 -->|履歴ボタン| SCR004
    SCR003 -->|履歴ボタン| SCR004

    SCR001 -->|設定ボタン| SCR005
    SCR002 -->|設定ボタン| SCR005
    SCR003 -->|設定ボタン| SCR005

    SCR003 -->|ASCIIボタン| SCR006

    SCR004 -->|閉じる| SCR001
    SCR004 -->|閉じる| SCR002
    SCR004 -->|閉じる| SCR003

    SCR005 -->|閉じる| SCR001
    SCR005 -->|閉じる| SCR002
    SCR005 -->|閉じる| SCR003

    SCR006 -->|閉じる| SCR003
```

---

## 2. 遷移図（ASCIIアート版）

```
┌─────────────────────────────────────────────────────────────────────┐
│                         アプリケーション起動                          │
└────────────────────────────────┬────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ┌─────────────┐    タブ切替    ┌─────────────┐    タブ切替        │
│  │  SCR-001    │ ◄───────────► │  SCR-002    │ ◄──────────┐      │
│  │  標準電卓   │                │  関数電卓   │            │      │
│  └──────┬──────┘                └──────┬──────┘            │      │
│         │                              │                   │      │
│         │    タブ切替                  │                   │      │
│         └────────────┬─────────────────┘                   │      │
│                      │                                     │      │
│                      ▼                                     │      │
│              ┌─────────────┐                               │      │
│              │  SCR-003    │ ◄─────────────────────────────┘      │
│              │プログラマ電卓│                                      │
│              └──────┬──────┘                                      │
│                     │                                             │
│                     │ ASCIIボタン                                 │
│                     ▼                                             │
│              ┌─────────────┐                                      │
│              │  SCR-006    │                                      │
│              │ ASCII変換   │                                      │
│              └─────────────┘                                      │
│                                                                   │
├───────────────────────────────────────────────────────────────────┤
│                     共通遷移（全メイン画面から）                    │
├───────────────────────────────────────────────────────────────────┤
│                                                                   │
│   履歴ボタン ─────────────► ┌─────────────┐                       │
│                             │  SCR-004    │                       │
│   閉じる ◄─────────────── │  履歴パネル  │                       │
│                             └─────────────┘                       │
│                                                                   │
│   設定ボタン ─────────────► ┌─────────────┐                       │
│                             │  SCR-005    │                       │
│   閉じる ◄─────────────── │ テーマ設定  │                       │
│                             └─────────────┘                       │
│                                                                   │
└───────────────────────────────────────────────────────────────────┘
```

---

## 3. 遷移条件一覧

### 3.1 メイン画面間の遷移

| No | 遷移元 | 遷移先 | トリガー | 条件 | 備考 |
|----|--------|--------|----------|------|------|
| 1 | SCR-001 | SCR-002 | 関数タブクリック | なし | 入力値維持 |
| 2 | SCR-001 | SCR-003 | プログラマタブクリック | なし | 入力値維持（整数のみ） |
| 3 | SCR-002 | SCR-001 | 標準タブクリック | なし | 入力値維持 |
| 4 | SCR-002 | SCR-003 | プログラマタブクリック | なし | 入力値維持（整数のみ） |
| 5 | SCR-003 | SCR-001 | 標準タブクリック | なし | 入力値維持 |
| 6 | SCR-003 | SCR-002 | 関数タブクリック | なし | 入力値維持 |

### 3.2 パネル・ダイアログへの遷移

| No | 遷移元 | 遷移先 | トリガー | 条件 | 備考 |
|----|--------|--------|----------|------|------|
| 7 | SCR-001/002/003 | SCR-004 | 履歴ボタン | なし | サイド表示 or オーバーレイ |
| 8 | SCR-001/002/003 | SCR-005 | 設定ボタン | なし | モーダル表示 |
| 9 | SCR-003 | SCR-006 | ASCIIボタン | なし | モーダル表示 |

### 3.3 パネル・ダイアログからの遷移

| No | 遷移元 | 遷移先 | トリガー | 条件 | 備考 |
|----|--------|--------|----------|------|------|
| 10 | SCR-004 | 元の画面 | 閉じるボタン | なし | パネル非表示 |
| 11 | SCR-004 | 元の画面 | パネル外クリック | モバイル時 | パネル非表示 |
| 12 | SCR-005 | 元の画面 | 閉じるボタン | なし | ダイアログ非表示 |
| 13 | SCR-005 | 元の画面 | オーバーレイクリック | なし | ダイアログ非表示 |
| 14 | SCR-005 | 元の画面 | Escapeキー | なし | ダイアログ非表示 |
| 15 | SCR-006 | SCR-003 | 閉じるボタン | なし | ダイアログ非表示 |
| 16 | SCR-006 | SCR-003 | オーバーレイクリック | なし | ダイアログ非表示 |
| 17 | SCR-006 | SCR-003 | Escapeキー | なし | ダイアログ非表示 |

### 3.4 履歴項目からの遷移

| No | 遷移元 | 遷移先 | トリガー | 条件 | 備考 |
|----|--------|--------|----------|------|------|
| 18 | SCR-004 | 元の画面 | 履歴項目クリック | なし | 結果値を入力反映 |

---

## 4. 状態遷移（モード別）

### 4.1 電卓モード状態

```
┌───────────┐      タブ切替      ┌───────────┐      タブ切替      ┌───────────┐
│  標準     │ ◄───────────────► │  関数     │ ◄───────────────► │プログラマ │
│  モード   │                    │  モード   │                    │  モード   │
└───────────┘                    └───────────┘                    └───────────┘
      │                                │                                │
      │ 設定                           │ 設定                           │ 設定/ASCII
      ▼                                ▼                                ▼
┌───────────┐                    ┌───────────┐                    ┌───────────┐
│ SCR-005   │                    │ SCR-005   │                    │SCR-005/006│
│ テーマ    │                    │ テーマ    │                    │           │
└───────────┘                    └───────────┘                    └───────────┘
```

### 4.2 パネル表示状態

```
┌─────────────────────────────────────────────────────────────────┐
│                      パネル表示状態                              │
└─────────────────────────────────────────────────────────────────┘

                    ┌──────────┐
                    │  非表示  │
                    └────┬─────┘
                         │ 履歴ボタン / 設定ボタン / ASCIIボタン
                         ▼
                    ┌──────────┐
                    │  表示中  │ ◄──┐
                    └────┬─────┘    │ 操作継続
                         │         │
                         └─────────┘
                         │
                         │ 閉じる / オーバーレイクリック / Escape
                         ▼
                    ┌──────────┐
                    │  非表示  │
                    └──────────┘
```

---

## 5. 初期表示フロー

```
┌─────────────────────────────────────────────────────────────────┐
│                        アプリ起動                                │
└────────────────────────────────┬────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│ 1. LocalStorageから設定読み込み                                  │
│    - calc_theme: テーマ名                                       │
│    - calc_darkMode: ライト/ダーク                               │
│    - calc_lastMode: 最後に使用したモード                        │
│    - calc_history: 計算履歴                                     │
└────────────────────────────────┬────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│ 2. テーマ・モード適用                                            │
└────────────────────────────────┬────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│ 3. 最後に使用したモードで起動                                    │
│    - 設定なし: SCR-001（標準電卓）                               │
│    - standard: SCR-001                                          │
│    - scientific: SCR-002                                        │
│    - programmer: SCR-003                                        │
└────────────────────────────────┬────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────┐
│ 4. 操作待ち状態                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. レスポンシブ遷移

### デスクトップ（1024px以上）

- 履歴パネル: サイドに常時表示（トグル可）
- ダイアログ: 中央にモーダル表示

### タブレット（768px〜1023px）

- 履歴パネル: 下部に折りたたみ表示
- ダイアログ: 中央にモーダル表示

### スマートフォン（767px以下）

- 履歴パネル: フルスクリーンオーバーレイ
- ダイアログ: フルスクリーンオーバーレイ

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 変更者 |
|------|------------|----------|--------|
| 2025-12-11 | 1.0 | 初版作成 | Claude Code |
